---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "zillaforge_keypair Resource - zillaforge"
subcategory: ""
description: |-
  Manages SSH keypairs for VPS instance access in ZillaForge. Supports both user-provided public keys and system-generated keypairs. Note: keypair name and public key are immutable after creation.
---

# zillaforge_keypair (Resource)

Manages SSH keypairs for VPS instance access in ZillaForge. Supports both user-provided public keys and system-generated keypairs. Note: keypair name and public key are immutable after creation.

## Example Usage

```terraform
# Example 1: System-generated keypair (recommended for most use cases)
resource "zillaforge_keypair" "auto_generated" {
  name        = "auto-generated-key"
  description = "System-generated SSH keypair for web servers"
}

# Output the generated keys (save private_key securely!)
output "auto_public_key" {
  description = "Public key to share with team or external services"
  value       = zillaforge_keypair.auto_generated.public_key
}

output "auto_private_key" {
  description = "Private key for SSH access (SAVE THIS SECURELY - shown once)"
  value       = zillaforge_keypair.auto_generated.private_key
  sensitive   = true # Prevents display in console output
}

output "auto_fingerprint" {
  description = "Key fingerprint for verification"
  value       = zillaforge_keypair.auto_generated.fingerprint
}

# Example 2: User-provided public key (bring your own key)
resource "zillaforge_keypair" "user_provided" {
  name        = "team-shared-key"
  description = "Shared team key for production servers"
  public_key  = file("~/.ssh/id_ed25519.pub") # Read from local file
}

# Note: private_key will be null for user-provided keys
output "user_keypair_id" {
  description = "Keypair ID for reference in other resources"
  value       = zillaforge_keypair.user_provided.id
}

# Example 3: Minimal configuration (system-generated, no description)
resource "zillaforge_keypair" "minimal" {
  name = "minimal-example"
}

# Example 4: Update description (only updatable field)
resource "zillaforge_keypair" "updatable" {
  name        = "example-key"
  description = "Initial description" # Can be changed without replacement
}

# Changing name or public_key forces replacement:
# terraform plan will show:
#   # zillaforge_keypair.updatable must be replaced
#   -/+ resource "zillaforge_keypair" "updatable" {
#         name = "example-key" -> "new-name"  # forces replacement
#       }
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Human-readable name for the keypair. Must be unique within the project. **Immutable** - changing this value forces resource replacement.

### Optional

- `description` (String) Optional description providing context about the keypair's purpose or usage. This is the only updatable attribute.
- `public_key` (String) SSH public key in OpenSSH format (ssh-rsa, ecdsa-sha2-*, ssh-ed25519). If omitted, the system generates a keypair automatically and returns both public and private keys. **Immutable** - changing this value forces resource replacement.

### Read-Only

- `fingerprint` (String) Cryptographic fingerprint of the public key (SHA256 or MD5 hash format).
- `id` (String) Unique identifier for the keypair (UUID format). Assigned by the API upon creation.
- `private_key` (String, Sensitive) Private key for SSH authentication. **Only available for system-generated keypairs** (when `public_key` is not provided). The private key is returned only once during creation and marked as sensitive to prevent exposure in logs or console output. For user-provided public keys, this field remains null.

## Import

Import is supported using the following syntax:

```shell
#!/bin/bash
# Import an existing keypair by ID
# Usage: ./import.sh <keypair-id>

KEYPAIR_ID=${1:-"550e8400-e29b-41d4-a716-446655440000"}

echo "Importing keypair with ID: $KEYPAIR_ID"
echo "Note: Imported keypairs will have private_key set to null (not available after creation)"

terraform import zillaforge_keypair.existing "$KEYPAIR_ID"

# After import, run terraform plan to see the imported state:
# terraform plan
#
# Example output:
#   zillaforge_keypair.existing:
#     id          = "550e8400-e29b-41d4-a716-446655440000"
#     name        = "imported-key"
#     description = "Existing keypair"
#     public_key  = "ssh-ed25519 AAAAC3Nza..."
#     fingerprint = "SHA256:abc123..."
#     private_key = null  # Never available for imported resources
```
